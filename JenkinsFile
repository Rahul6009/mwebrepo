pipeline {
    agent any
    environment {
	    PATH = "/usr/share/maven/bin:$PATH"
    }
    stages {
        stage('CodeCheckout') {
            steps {
	       git branch: 'main', credentialsId: 'git_credentials', url: 'https://github.com/Rahul6009/mwebrepo.git'
               echo "CodeCheckout executed.." 
                  }
                          }
        stage('Codebuild') {
            steps {
                sh 'mvn clean install'
                echo "Codebuild executed.."
                  }
        stage('CodeDeploy') {
            steps {
        sshagent(['deploy_user']) {
            sh "scp -o StrictHostKeyChecking=no webapp/target/webapp.war  ubuntu@3.135.231.11:/opt/apache-tomcat-9.0.64/webapps"
            echo ""		
                                }
                }


	    }
        }
    }
